<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Oven Shift Performance</title>

  <link rel="stylesheet" href="/styles.css" />

  <style>
    .oven-wrap { max-width: 1200px; margin: 20px auto; padding: 0 12px; }

    /* Restore the original simple control layout */
    .oven-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: flex-end; /* natural alignment with label+input blocks */
    }

    .oven-controls label {
      font-weight: 800;
      display: block;
      margin-bottom: 6px;
    }

    .oven-controls input,
    .oven-controls select {
      padding: 10px;
      font-size: 16px;
    }

    /* Keep buttons consistent on this page */
    .btn { padding: 10px 14px; font-weight: 900; cursor: pointer; }

    .row { display:flex; gap:10px; flex-wrap:wrap; }

    .card { background:#fff; border:1px solid #ddd; border-radius:10px; padding:12px 14px; min-width:220px; }
    .card h3 { margin:0 0 6px 0; }
    .muted { color:#666; }

    canvas { background:#fff; border:1px solid #ddd; border-radius:10px; width:100%; height:420px; }
    #shiftBarChart { height: 320px; }

    .legend { display:flex; gap:14px; flex-wrap:wrap; margin-top:10px; }
    .legend .item { display:flex; align-items:center; gap:8px; font-weight:800; }
    .swatch { width:14px; height:14px; border-radius:3px; display:inline-block; }
    .error { color:#b00020; font-weight:900; margin-top:10px; }

    /* Dark mode overrides for oven page (keeps it consistent) */
    .theme-dark .oven-wrap .muted { color: var(--muted); }
    .theme-dark .oven-wrap .card { background: var(--panel); border-color: var(--border); color: var(--text); }
    .theme-dark .oven-wrap canvas { background: #0f1419; border-color: var(--border); }
  </style>
</head>

<section class="panel" id="cureSection">
  <h2>Avg Cure Time (5 min buckets)</h2>
  <canvas id="cureChart" width="1200" height="360"></canvas>
  <div class="muted">Goal range: 45–120 minutes</div>
</section>


<body>
  <div id="topnav"></div>

  <div class="oven-wrap">
    <h1 style="margin-top:8px;">Oven Shift Performance</h1>
    <div class="muted">
      Completed plugs over time. Use “Chart View” to switch visualizations.
    </div>

    <div class="oven-controls" style="margin-top:14px;">
      <div>
        <label for="start">Start</label>
        <input id="start" type="datetime-local" />
      </div>

      <div>
        <label for="end">End</label>
        <input id="end" type="datetime-local" />
      </div>

      <button class="btn" id="applyBtn" type="button">Apply</button>
      <button class="btn secondary" id="downloadCsvBtn" type="button">Download CSV</button>
      <button class="btn" id="todayBtn" type="button">Today</button>
      <button class="btn" id="shiftBtn" type="button">This Shift</button>
      <button class="btn" id="yesterdayBtn" type="button">Yesterday</button>
      

      <div>
        <label for="chartView">Chart View</label>
        <select id="chartView">
          <option value="timeseries" selected>Time Series (5 min)</option>
          <option value="shiftType">Shift Totals (1st/2nd/3rd)</option>
          <option value="shiftInstance">Shift Instances (Day + Shift)</option>
          <option value="cureTimeseries">Cure Time (Avg)</option>
        </select>
      </div>

        <!-- Add near Chart View / Shift Chart Size -->
        <div class="cg ts-view">
          <label for="tsSizeFilter">Time Series Size</label>
          <select id="tsSizeFilter">
            <option value="ALL" selected>All sizes</option>
            <!-- JS will populate sizes found in data -->
          </select>
        </div>

      <label style="display:flex; gap:8px; align-items:center; margin-left:8px; font-weight:900;">
        <input id="live" type="checkbox" />
        Live (refresh 60s)
      </label>
      <button class="btn" id="lastWeekBtn" type="button">Last Week</button>
      <button id="lastHourBtn" class="btn secondary" title="Rolling last 60 minutes (live)">Last Production Hour (live)</button>

    </div>
    

    <div class="row" style="margin-top:14px;" id="shiftCards"></div>
    <div class="row" style="margin-top:14px;" id="kpiCards"></div>

    <!-- TIME SERIES SECTION -->
    <div id="timeseriesSection" style="margin-top:14px;">
      <canvas id="chart" width="1200" height="420"></canvas>
      <div class="legend" id="legend"></div>
    </div>

    <!-- SHIFT BAR SECTION -->
    <div id="shiftBarsSection" style="margin-top:14px; display:none;">
      <canvas id="shiftBarChart" width="1200" height="420"></canvas>
      <div class="legend" id="shiftLegend"></div>
    </div>

    <div class="error" id="error" style="display:none;"></div>
  </div>

  <script src="/nav.js"></script>
  <script src="/oven.js"></script>
</body>
</html>